
# 🍻 מערכת לניהול בר – פרויקט בסיסי נתונים (שלב ב)

## 📌 סקירה כללית

בשלב זה נבצע שאילתות ושינויים קטנים בבסיס נתונים כדי לראות שאכן הכל מוגדר כראוי ושהבסיס נתונים מוכן למיזוג בשלב השלישי.

---

## 🧾 פרטי ההגשה – שלב ב'

- **שמות מגישים:** יוסף חפץ, יהודה גודפרי
- **שם המערכת:** מערכת לניהול בר
- **היחידה הנבחרת:** ניהול הזמנות וספקים

---

## 📚 תוכן העניינים

1. [הסבר שאילתות Select
   ](#מבוא)
2. [הסבר שאילות Update
   ](#מבוא)
3. [הסבר שאילתות Delete
   ](#מבוא)
4. [הסבר אילוצים
   ](#מבוא)
5. [הסבר Rollback ו-Commit
   ](#מבוא)

---



## שאילתות SELECT

### 1. רשימת ברמנים עם השכר, שם ותאריך לידה

שאילתה זו מציגה את שמות הברמנים, תאריכי הלידה שלהם והשכר שלהם, כאשר התוצאות מסודרות בסדר יורד לפי השכר. היא משלבת את טבלת האנשים (person) עם טבלת הברמנים (bartender) באמצעות מזהה האדם.

### 2. משקאות עם אלכוהול מעל 5%, כולל שם, סוג, תכולת אלכוהול ושם ברמן שאחראי

שאילתה זו מציגה את כל המשקאות שתכולת האלכוהול שלהם גבוהה מ-5%, כולל שם המשקה, הסוג, אחוז האלכוהול ושם הברמן האחראי עליו. התוצאות מסודרות בסדר יורד לפי תכולת האלכוהול.

### 3. הזמנות שבוצעו בחודש אפריל 2025

שאילתה זו מושכת את כל ההזמנות שבוצעו בחודש אפריל 2025, כולל מזהה ההזמנה, התאריך, החודש (שנשלף באמצעות פונקציית EXTRACT), שיטת התשלום ושם הברמן שטיפל בהזמנה.

### 4. מוצרים עם תוקף של פחות משנה

שאילתה זו מציגה מוצרים שחיי המדף שלהם קצרים משנה אחת (פחות מ-12 חודשים), כולל שם המוצר, חיי המדף, סוג המוצר ומיקום האחסון שלו.

### 5. ממוצע משכורות ברמנים לפי רמת מומחיות בבירה

שאילתה זו מחשבת את השכר הממוצע של ברמנים בהתאם לרמת המומחיות שלהם בבירה, מקבצת את התוצאות לפי רמת מומחיות ומסדרת אותן בסדר יורד לפי השכר הממוצע.

### 6. רשימת אנשים שאינם ברמנים

שאילתה זו מציגה את שמות וגילאי האנשים שאינם רשומים כברמנים, כלומר אנשים שהמזהה שלהם לא מופיע בטבלת הברמנים.

### 7. כמות משקאות שנמכרו בכל הזמנה

שאילתה זו סופרת את מספר המשקאות שנמכרו בכל הזמנה, מציגה את מזהה ההזמנה ואת סך המשקאות, כאשר התוצאות מסודרות בסדר יורד לפי מספר המשקאות.

### 8. פירוט מוצרים המכילים גם גלוטן וגם אגוזים

שאילתה זו מציגה מוצרים שמכילים הן גלוטן והן אגוזים (כלומר, שאינם gluten-free ואינם nut-free, המצוינים על ידי ערך 0).

---

## שאילתות DELETE

### 1. מחיקת ברמנים עם ניסיון של פחות משנה

שאילתה זו מוחקת את כל הרשומות של ברמנים שיש להם פחות משנת ניסיון.

### 2. מחיקת מוצרים שתוקפם פחות מ-3 חודשים

שאילתה זו מוחקת את כל המוצרים שחיי המדף שלהם קצרים מ-3 חודשים.

### 3. מחיקת משקאות עם 0% אלכוהול ובלי סוכר

שאילתה זו מוחקת את כל המשקאות שאין בהם כלל אלכוהול (0%) ושהם ללא סוכר.

---

## שאילתות UPDATE

### 1. עדכון שכר ברמנים עם מומחיות בבירה לרמה 5 ומעלה

שאילתה זו מעלה את שכר הברמנים ב-10% (מכפילה את השכר הנוכחי ב-1.1) עבור כל הברמנים שרמת המומחיות שלהם בבירה היא 5 ומעלה.

### 2. עדכון סוג מוצר לטבעוני אם הוא ללא גלוטן, ללא אגוזים וצמחוני

שאילתה זו מעדכנת את סטטוס המוצר לטבעוני (vegan=1) אם המוצר הוא ללא גלוטן, ללא אגוזים וכבר מסומן כצמחוני.

### 3. עדכון כתובת לאנשים מאזור קידוד מסוים

שאילתה זו מעדכנת את הכתובת ל-'Updated Address' עבור כל האנשים שמתגוררים באזור עם קוד האזור '12345'.

---

## שאילתות Rollback ו-Commit

הסבר:
הפקודה BEGIN; פותחת טרנזאקציה – קבוצה של פעולות שמתבצעות יחד.

הפקודה UPDATE משנה את ערך wage (השכר) עבור ברמנים לפי תנאים שונים.

הפקודה ROLLBACK מבטלת את כל הפעולות שבוצעו מאז ה־BEGIN האחרון.

ביצוע ה-COMMIT שומר את כל השינויים לצמיתות בבסיס הנתונים.

שימוש ב־SELECT לפני ואחרי מאפשר לבדוק אם השינויים נשמרו או בוטלו.